import{u as q}from"./auth-DQHpPayR.js";import{C as N,a as E,L as H,P as Q,b as U,p as W,c as Z,d as G,e as J}from"./index-fKZwiHeB.js";import{f as O}from"./format-sbWH3_uq.js";import{d as K,c as X,a as f,r as Y,l as tt,b as c,m as D,o as S,f as e,w as s,g as a,t as d,j as o,v as et,F as st,n as at,_ as ot}from"./index-ChimEHM8.js";const lt={class:"d-flex align-center justify-space-between"},it={class:"text-body-1 text-medium-emphasis"},nt={class:"d-flex align-center"},dt={class:"mr-4"},rt={class:"text-h4 font-weight-bold white--text mb-1"},ct={class:"mt-4"},ut={class:"d-flex align-center"},mt={class:"mr-4"},pt={class:"text-h4 font-weight-bold white--text mb-1"},vt={class:"mt-4"},ft={class:"d-flex align-center"},_t={class:"mr-4"},ht={class:"text-h4 font-weight-bold white--text mb-1"},gt={class:"mt-4"},bt={class:"d-flex align-center"},wt={class:"mr-4"},xt={class:"text-h4 font-weight-bold white--text mb-1"},yt={class:"mt-4"},kt={class:"chart-container"},Dt={class:"d-flex align-center justify-space-between"},St={class:"flex-grow-1"},Ct={class:"text-body-2 font-weight-medium"},zt={class:"text-caption text-medium-emphasis"},Ot={class:"text-right"},Vt={class:"text-body-2 font-weight-bold"},Tt=K({__name:"DashboardView",setup(jt){N.register(E,H,Q,U,W,Z,G);const V=q(),T=X(()=>V.user),w=f(!1),_=f("30d"),p=Y({orders:{total:0,completed:0,pending:0,paid:0,revenue30Days:0,totalRevenue:0,averageOrderValue:0},products:{total:0,active:0,lowStock:0,outOfStock:0},customers:{total:0,new30Days:0,averageValue:0}}),C=f([]),h=f([]),x=f({labels:[],datasets:[{label:"Revenue",data:[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0}]}),j={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:l=>`€${l.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{callback:l=>`€${l.toLocaleString()}`}}}},A=[{title:"Order #",key:"order_number",width:"120px"},{title:"Customer",key:"customer_email"},{title:"Status",key:"status",width:"100px"},{title:"Total",key:"total",width:"100px"},{title:"Date",key:"created_at",width:"120px"},{title:"Actions",key:"actions",width:"80px",sortable:!1}],L=l=>({pending:"warning",processing:"info",shipped:"primary",delivered:"success",cancelled:"error"})[l]||"grey",M=l=>O(new Date(l),"MMM dd, yyyy"),R=async()=>{await z(),await y()},z=async()=>{try{w.value=!0,console.log("Dashboard: Making request to /api/analytics/dashboard/overview");const l=localStorage.getItem("auth_token");console.log("Dashboard: Token from localStorage:",l?l.substring(0,20)+"...":"null");const t=await fetch("/api/analytics/dashboard/overview",{headers:{Authorization:l?`Bearer ${l}`:"","Content-Type":"application/json"}});console.log("Dashboard: Response status:",t.status);const n=await t.json();n.success&&(Object.assign(p,n.data.overview),C.value=n.data.recentOrders,h.value=n.data.topProducts)}catch(l){console.error("Failed to load dashboard data:",l)}finally{w.value=!1}},y=async()=>{try{const l=localStorage.getItem("auth_token"),n=await(await fetch(`/api/analytics/sales?groupBy=day&startDate=${P()}&endDate=${new Date().toISOString().split("T")[0]}`,{headers:{Authorization:l?`Bearer ${l}`:"","Content-Type":"application/json"}})).json();n.success&&(x.value.labels=n.data.sales.map(r=>O(new Date(r.period),"MMM dd")),x.value.datasets[0].data=n.data.sales.map(r=>r.revenue))}catch(l){console.error("Failed to load chart data:",l)}},P=()=>{const l=_.value==="7d"?7:_.value==="90d"?90:30,t=new Date;return t.setDate(t.getDate()-l),t.toISOString().split("T")[0]};return tt(()=>{z(),y()}),(l,t)=>{const n=c("v-btn"),r=c("v-col"),k=c("v-row"),u=c("v-icon"),v=c("v-chip"),m=c("v-card"),B=c("v-select"),g=c("v-card-title"),b=c("v-card-text"),$=c("v-data-table"),F=c("v-progress-linear");return S(),D("div",null,[e(k,{class:"mb-6"},{default:s(()=>[e(r,{cols:"12"},{default:s(()=>{var i;return[a("div",lt,[a("div",null,[t[1]||(t[1]=a("h1",{class:"text-h4 font-weight-bold mb-2"},"Dashboard",-1)),a("p",it," Welcome back, "+d((i=T.value)==null?void 0:i.firstName)+"! Here's what's happening with your business. ",1)]),e(n,{color:"primary","prepend-icon":"mdi-refresh",onClick:R,loading:w.value},{default:s(()=>[...t[2]||(t[2]=[o(" Refresh ",-1)])]),_:1},8,["loading"])])]}),_:1})]),_:1}),e(k,{class:"mb-6"},{default:s(()=>[e(r,{cols:"12",sm:"6",md:"3"},{default:s(()=>[e(m,{class:"dashboard-card stats-gradient-primary pa-6",elevation:"0"},{default:s(()=>[a("div",nt,[a("div",dt,[e(u,{size:"48",color:"white"},{default:s(()=>[...t[3]||(t[3]=[o("mdi-shopping",-1)])]),_:1})]),a("div",null,[a("div",rt,d(p.orders.total),1),t[4]||(t[4]=a("div",{class:"text-caption white--text opacity-8"},"Total Orders",-1))])]),a("div",ct,[e(v,{size:"small",color:"white",variant:"outlined",class:"white--text"},{default:s(()=>[e(u,{size:"16",class:"mr-1"},{default:s(()=>[...t[5]||(t[5]=[o("mdi-trending-up",-1)])]),_:1}),t[6]||(t[6]=o(" +12% this month ",-1))]),_:1})])]),_:1})]),_:1}),e(r,{cols:"12",sm:"6",md:"3"},{default:s(()=>[e(m,{class:"dashboard-card stats-gradient-success pa-6",elevation:"0"},{default:s(()=>[a("div",ut,[a("div",mt,[e(u,{size:"48",color:"white"},{default:s(()=>[...t[7]||(t[7]=[o("mdi-currency-eur",-1)])]),_:1})]),a("div",null,[a("div",pt," €"+d(p.orders.totalRevenue.toLocaleString()),1),t[8]||(t[8]=a("div",{class:"text-caption white--text opacity-8"},"Total Revenue",-1))])]),a("div",vt,[e(v,{size:"small",color:"white",variant:"outlined",class:"white--text"},{default:s(()=>[e(u,{size:"16",class:"mr-1"},{default:s(()=>[...t[9]||(t[9]=[o("mdi-trending-up",-1)])]),_:1}),t[10]||(t[10]=o(" +8% this month ",-1))]),_:1})])]),_:1})]),_:1}),e(r,{cols:"12",sm:"6",md:"3"},{default:s(()=>[e(m,{class:"dashboard-card stats-gradient-warning pa-6",elevation:"0"},{default:s(()=>[a("div",ft,[a("div",_t,[e(u,{size:"48",color:"white"},{default:s(()=>[...t[11]||(t[11]=[o("mdi-package-variant",-1)])]),_:1})]),a("div",null,[a("div",ht,d(p.products.total),1),t[12]||(t[12]=a("div",{class:"text-caption white--text opacity-8"},"Total Products",-1))])]),a("div",gt,[e(v,{size:"small",color:"white",variant:"outlined",class:"white--text"},{default:s(()=>[e(u,{size:"16",class:"mr-1"},{default:s(()=>[...t[13]||(t[13]=[o("mdi-package-variant-closed",-1)])]),_:1}),o(" "+d(p.products.active)+" active ",1)]),_:1})])]),_:1})]),_:1}),e(r,{cols:"12",sm:"6",md:"3"},{default:s(()=>[e(m,{class:"dashboard-card stats-gradient-info pa-6",elevation:"0"},{default:s(()=>[a("div",bt,[a("div",wt,[e(u,{size:"48",color:"white"},{default:s(()=>[...t[14]||(t[14]=[o("mdi-account-group",-1)])]),_:1})]),a("div",null,[a("div",xt,d(p.customers.total),1),t[15]||(t[15]=a("div",{class:"text-caption white--text opacity-8"},"Total Customers",-1))])]),a("div",yt,[e(v,{size:"small",color:"white",variant:"outlined",class:"white--text"},{default:s(()=>[e(u,{size:"16",class:"mr-1"},{default:s(()=>[...t[16]||(t[16]=[o("mdi-account-plus",-1)])]),_:1}),o(" +"+d(p.customers.new30Days)+" new ",1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(k,null,{default:s(()=>[e(r,{cols:"12",lg:"8"},{default:s(()=>[e(m,{class:"dashboard-card pa-6 mb-6"},{default:s(()=>[e(g,{class:"d-flex align-center justify-space-between"},{default:s(()=>[t[17]||(t[17]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold mb-1"},"Sales Overview"),a("p",{class:"text-body-2 text-medium-emphasis mb-0"},"Revenue trends over the last 30 days")],-1)),e(B,{modelValue:_.value,"onUpdate:modelValue":[t[0]||(t[0]=i=>_.value=i),y],items:["7d","30d","90d"],density:"compact",variant:"outlined",class:"w-auto"},null,8,["modelValue"])]),_:1}),e(b,null,{default:s(()=>[a("div",kt,[e(et(J),{data:x.value,options:j},null,8,["data"])])]),_:1})]),_:1}),e(m,{class:"dashboard-card pa-6"},{default:s(()=>[e(g,{class:"d-flex align-center justify-space-between"},{default:s(()=>[t[20]||(t[20]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold mb-1"},"Recent Orders"),a("p",{class:"text-body-2 text-medium-emphasis mb-0"},"Latest customer orders")],-1)),e(n,{text:"",color:"primary",to:"/orders"},{default:s(()=>[t[19]||(t[19]=o(" View All ",-1)),e(u,{right:""},{default:s(()=>[...t[18]||(t[18]=[o("mdi-arrow-right",-1)])]),_:1})]),_:1})]),_:1}),e(b,null,{default:s(()=>[e($,{headers:A,items:C.value,"items-per-page":5,density:"compact",class:"transparent-table"},{"item.status":s(({item:i})=>[e(v,{color:L(i.status),size:"small",variant:"flat"},{default:s(()=>[o(d(i.status),1)]),_:2},1032,["color"])]),"item.total":s(({item:i})=>[o(" €"+d(i.total.toFixed(2)),1)]),"item.created_at":s(({item:i})=>[o(d(M(i.created_at)),1)]),"item.actions":s(({item:i})=>[e(n,{icon:"",size:"small",variant:"text",to:`/orders/${i.id}`},{default:s(()=>[e(u,null,{default:s(()=>[...t[21]||(t[21]=[o("mdi-eye",-1)])]),_:1})]),_:1},8,["to"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",lg:"4"},{default:s(()=>[e(m,{class:"dashboard-card pa-6 mb-6"},{default:s(()=>[e(g,null,{default:s(()=>[...t[22]||(t[22]=[a("h2",{class:"text-h6 font-weight-bold mb-1"},"Top Products",-1),a("p",{class:"text-caption text-medium-emphasis mb-0"},"Best performing items",-1)])]),_:1}),e(b,null,{default:s(()=>[(S(!0),D(st,null,at(h.value.slice(0,5),i=>(S(),D("div",{key:i.name,class:"mb-4"},[a("div",Dt,[a("div",St,[a("div",Ct,d(i.name),1),a("div",zt,d(i.quantity_sold)+" sold",1)]),a("div",Ot,[a("div",Vt,"€"+d(i.revenue.toFixed(0)),1)])]),e(F,{value:h.value.length>0?i.quantity_sold/Math.max(...h.value.map(I=>I.quantity_sold))*100:0,color:"primary",height:"4",class:"mt-2"},null,8,["value"])]))),128))]),_:1})]),_:1}),e(m,{class:"dashboard-card pa-6"},{default:s(()=>[e(g,null,{default:s(()=>[...t[23]||(t[23]=[a("h2",{class:"text-h6 font-weight-bold mb-1"},"Quick Actions",-1),a("p",{class:"text-caption text-medium-emphasis mb-0"},"Common tasks",-1)])]),_:1}),e(b,null,{default:s(()=>[e(n,{block:"",color:"primary",class:"mb-3",to:"/products/create","prepend-icon":"mdi-plus"},{default:s(()=>[...t[24]||(t[24]=[o(" Add Product ",-1)])]),_:1}),e(n,{block:"",color:"success",class:"mb-3",to:"/orders","prepend-icon":"mdi-shopping"},{default:s(()=>[...t[25]||(t[25]=[o(" View Orders ",-1)])]),_:1}),e(n,{block:"",color:"info",class:"mb-3",to:"/analytics","prepend-icon":"mdi-chart-line"},{default:s(()=>[...t[26]||(t[26]=[o(" View Analytics ",-1)])]),_:1}),e(n,{block:"",color:"warning",variant:"outlined",to:"/inventory","prepend-icon":"mdi-warehouse"},{default:s(()=>[...t[27]||(t[27]=[o(" Check Inventory ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Pt=ot(Tt,[["__scopeId","data-v-c6ebdb52"]]);export{Pt as default};
