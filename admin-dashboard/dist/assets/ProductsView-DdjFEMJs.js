import{u as le}from"./auth-DQHpPayR.js";import{d as ne,a as i,c as ie,l as de,b as l,m as re,o as ue,f as a,w as t,g as c,v,j as n,t as r,s as ce,_ as pe}from"./index-ChimEHM8.js";import{f as me}from"./format-sbWH3_uq.js";const ve={class:"d-flex align-center justify-space-between"},_e={class:"d-flex flex-column"},fe={class:"font-weight-medium"},ye={class:"text-caption text-medium-emphasis"},ge={class:"font-weight-medium"},be=ne({__name:"ProductsView",setup(we){const _=le(),C=i(!1),P=i(!1),w=i(""),k=i(""),x=i(""),L=i(10),V=i([{key:"created_at",order:"desc"}]),S=i([!0]),f=i(!1),y=i(null),D=i([]),F=i(["Electronics","Clothing","Home & Garden","Sports","Books"]),I=i([{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}]),M=[{title:"Image",key:"image",width:"80px",sortable:!1},{title:"Product",key:"name",width:"200px"},{title:"Category",key:"category",width:"120px"},{title:"Price",key:"price",width:"100px"},{title:"Stock",key:"stock_quantity",width:"100px"},{title:"Status",key:"status",width:"100px"},{title:"Created",key:"created_at",width:"120px"},{title:"Actions",key:"actions",width:"80px",sortable:!1}],U=ie(()=>{let o=D.value;if(w.value){const e=w.value.toLowerCase();o=o.filter(d=>{var u;return d.name.toLowerCase().includes(e)||d.sku.toLowerCase().includes(e)||((u=d.description)==null?void 0:u.toLowerCase().includes(e))})}return k.value&&(o=o.filter(e=>e.category===k.value)),x.value&&(o=o.filter(e=>e.status===x.value)),o}),q=o=>o===0?"error":o<=10?"warning":"success",z=o=>me(new Date(o),"MMM dd, yyyy"),N=(()=>{let o;return()=>{clearTimeout(o),o=setTimeout(()=>{},300)}})(),$=()=>{},O=o=>{V.value=o.sortBy,S.value=o.sortDesc},h=async()=>{try{C.value=!0;const e=await(await fetch("/api/products")).json();e.success&&(D.value=e.data)}catch(o){console.error("Failed to load products:",o)}finally{C.value=!1}},H=async o=>{try{(await(await fetch(`/api/products/${o.id}/duplicate`,{method:"POST"})).json()).success&&await h()}catch(e){console.error("Failed to duplicate product:",e)}},G=async o=>{try{const e=o.status==="active"?"inactive":"active";(await(await fetch(`/api/products/${o.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})).json()).success&&(o.status=e)}catch(e){console.error("Failed to toggle product status:",e)}},J=o=>{y.value=o,f.value=!0},Q=async()=>{if(y.value)try{P.value=!0,(await fetch(`/api/products/${y.value.id}`,{method:"DELETE"})).ok&&(f.value=!1,y.value=null,await h())}catch(o){console.error("Failed to delete product:",o)}finally{P.value=!1}};return de(()=>{h()}),(o,e)=>{const d=l("v-btn"),u=l("v-col"),T=l("v-row"),K=l("v-text-field"),A=l("v-select"),R=l("v-img"),W=l("v-avatar"),j=l("v-chip"),p=l("v-icon"),g=l("v-list-item-title"),b=l("v-list-item"),X=l("v-divider"),Y=l("v-list"),Z=l("v-menu"),ee=l("v-data-table"),B=l("v-card-text"),E=l("v-card"),te=l("v-card-title"),ae=l("v-spacer"),oe=l("v-card-actions"),se=l("v-dialog");return ue(),re("div",null,[a(T,{class:"mb-6"},{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[c("div",ve,[e[6]||(e[6]=c("div",null,[c("h1",{class:"text-h4 font-weight-bold mb-2"},"Products"),c("p",{class:"text-body-1 text-medium-emphasis"}," Manage your product catalog and inventory ")],-1)),a(d,{color:"primary","prepend-icon":"mdi-plus",to:"/products/create",disabled:!v(_).hasPermission("admin")},{default:t(()=>[...e[5]||(e[5]=[n(" Add Product ",-1)])]),_:1},8,["disabled"])])]),_:1})]),_:1}),a(T,{class:"mb-6"},{default:t(()=>[a(u,{cols:"12",md:"6"},{default:t(()=>[a(K,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),label:"Search products","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:"",onInput:v(N)},null,8,["modelValue","onInput"])]),_:1}),a(u,{cols:"12",md:"3"},{default:t(()=>[a(A,{modelValue:k.value,"onUpdate:modelValue":[e[1]||(e[1]=s=>k.value=s),$],items:F.value,label:"Category",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),a(u,{cols:"12",md:"3"},{default:t(()=>[a(A,{modelValue:x.value,"onUpdate:modelValue":[e[2]||(e[2]=s=>x.value=s),$],items:I.value,label:"Status",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}),a(E,{class:"dashboard-card"},{default:t(()=>[a(B,null,{default:t(()=>[a(ee,{headers:M,items:U.value,"items-per-page":L.value,loading:C.value,density:"compact",class:"transparent-table","sort-by":V.value,"sort-desc":S.value,"onUpdate:options":O},{"item.image":t(({item:s})=>[a(W,{size:"40"},{default:t(()=>[a(R,{src:s.image||"/placeholder-product.png",alt:s.name},null,8,["src","alt"])]),_:2},1024)]),"item.name":t(({item:s})=>[c("div",_e,[c("span",fe,r(s.name),1),c("span",ye,r(s.sku),1)])]),"item.price":t(({item:s})=>[c("span",ge,"â‚¬"+r(s.price.toFixed(2)),1)]),"item.stock_quantity":t(({item:s})=>[a(j,{color:q(s.stock_quantity),size:"small",variant:"flat"},{default:t(()=>[n(r(s.stock_quantity),1)]),_:2},1032,["color"])]),"item.status":t(({item:s})=>[a(j,{color:s.status==="active"?"success":"error",size:"small",variant:"flat"},{default:t(()=>[n(r(s.status),1)]),_:2},1032,["color"])]),"item.created_at":t(({item:s})=>[n(r(z(s.created_at)),1)]),"item.actions":t(({item:s})=>[a(Z,null,{activator:t(({props:m})=>[a(d,ce({icon:"",size:"small",variant:"text"},m),{default:t(()=>[a(p,null,{default:t(()=>[...e[7]||(e[7]=[n("mdi-dots-vertical",-1)])]),_:1})]),_:1},16)]),default:t(()=>[a(Y,null,{default:t(()=>[a(b,{onClick:m=>o.$router.push(`/products/${s.id}`)},{prepend:t(()=>[a(p,null,{default:t(()=>[...e[8]||(e[8]=[n("mdi-eye",-1)])]),_:1})]),default:t(()=>[a(g,null,{default:t(()=>[...e[9]||(e[9]=[n("View Details",-1)])]),_:1})]),_:1},8,["onClick"]),a(b,{onClick:m=>o.$router.push(`/products/${s.id}/edit`),disabled:!v(_).hasPermission("admin")},{prepend:t(()=>[a(p,null,{default:t(()=>[...e[10]||(e[10]=[n("mdi-pencil",-1)])]),_:1})]),default:t(()=>[a(g,null,{default:t(()=>[...e[11]||(e[11]=[n("Edit",-1)])]),_:1})]),_:1},8,["onClick","disabled"]),a(b,{onClick:m=>H(s),disabled:!v(_).hasPermission("admin")},{prepend:t(()=>[a(p,null,{default:t(()=>[...e[12]||(e[12]=[n("mdi-content-copy",-1)])]),_:1})]),default:t(()=>[a(g,null,{default:t(()=>[...e[13]||(e[13]=[n("Duplicate",-1)])]),_:1})]),_:1},8,["onClick","disabled"]),a(X),a(b,{onClick:m=>G(s),disabled:!v(_).hasPermission("admin")},{prepend:t(()=>[a(p,null,{default:t(()=>[n(r(s.status==="active"?"mdi-pause":"mdi-play"),1)]),_:2},1024)]),default:t(()=>[a(g,null,{default:t(()=>[n(r(s.status==="active"?"Deactivate":"Activate"),1)]),_:2},1024)]),_:2},1032,["onClick","disabled"]),a(b,{onClick:m=>J(s),disabled:!v(_).hasPermission("admin"),class:"error--text"},{prepend:t(()=>[a(p,{color:"error"},{default:t(()=>[...e[14]||(e[14]=[n("mdi-delete",-1)])]),_:1})]),default:t(()=>[a(g,null,{default:t(()=>[...e[15]||(e[15]=[n("Delete",-1)])]),_:1})]),_:1},8,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]),_:1},8,["items","items-per-page","loading","sort-by","sort-desc"])]),_:1})]),_:1}),a(se,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),"max-width":"400"},{default:t(()=>[a(E,null,{default:t(()=>[a(te,{class:"text-h6"},{default:t(()=>[...e[16]||(e[16]=[n("Delete Product",-1)])]),_:1}),a(B,null,{default:t(()=>{var s;return[n(' Are you sure you want to delete "'+r((s=y.value)==null?void 0:s.name)+'"? This action cannot be undone. ',1)]}),_:1}),a(oe,null,{default:t(()=>[a(ae),a(d,{variant:"text",onClick:e[3]||(e[3]=s=>f.value=!1)},{default:t(()=>[...e[17]||(e[17]=[n("Cancel",-1)])]),_:1}),a(d,{color:"error",variant:"text",onClick:Q,loading:P.value},{default:t(()=>[...e[18]||(e[18]=[n(" Delete ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Pe=pe(be,[["__scopeId","data-v-b5154f34"]]);export{Pe as default};
