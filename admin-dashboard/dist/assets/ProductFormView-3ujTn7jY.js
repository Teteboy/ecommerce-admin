import{d as H,x as K,u as L,y as W,r as G,a as f,c as J,l as Q,b as i,m as Z,o as X,f as l,w as t,g as m,j as w,t as q,h as Y,_ as ee}from"./index-ChimEHM8.js";import{u as le}from"./auth-DQHpPayR.js";const te={class:"d-flex align-center"},ae={class:"text-h4 font-weight-bold mb-2"},oe={class:"text-body-1 text-medium-emphasis"},se={class:"text-center"},de=H({__name:"ProductFormView",setup(ue){const x=K(),C=L();le();const U=W(),o=G({name:"",sku:"",category:"",price:0,stock_quantity:0,status:"active",description:"",weight:null,dimensions:"",brand:"",supplier:"",tags:"",seo_title:"",seo_description:"",image:null}),P=f(!1),d=f(!1),g=f(null),S=f(""),v=J(()=>!!x.params.id),h=f(["Electronics","Clothing","Home & Garden","Sports","Books","Beauty","Automotive","Health","Toys","Food"]),F=f([{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}]),R=[a=>!!a||"Product name is required",a=>a.length>=2||"Product name must be at least 2 characters",a=>a.length<=100||"Product name must be less than 100 characters"],D=[a=>!!a||"SKU is required",a=>/^[A-Z0-9-_]+$/.test(a)||"SKU must contain only uppercase letters, numbers, hyphens, and underscores"],E=[a=>!!a||"Category is required"],T=[a=>a>=0||"Price must be positive",a=>a<=999999.99||"Price must be less than 1,000,000"],A=[a=>a>=0||"Stock quantity must be positive",a=>Number.isInteger(a)||"Stock quantity must be a whole number"],O=[a=>!!a||"Status is required"],$=a=>{var b,p;const e=(p=(b=a.target)==null?void 0:b.files)==null?void 0:p[0];if(e){g.value=e;const u=new FileReader;u.onload=c=>{var n;S.value=(n=c.target)==null?void 0:n.result},u.readAsDataURL(e)}},N=async()=>{if(v.value)try{d.value=!0;const e=await(await fetch(`/api/products/${x.params.id}`)).json();e.success&&(Object.assign(o,e.data),e.data.image&&(S.value=e.data.image))}catch(a){console.error("Failed to load product:",a),U.error("Failed to load product")}finally{d.value=!1}},j=async()=>{try{d.value=!0;let a=o.image;if(g.value){const n=new FormData;n.append("file",g.value),n.append("type","product");const _=await(await fetch("/api/upload",{method:"POST",body:n})).json();if(_.success)a=_.data.url;else throw new Error("Failed to upload image")}const e={...o,image:a,tags:o.tags?o.tags.split(",").map(n=>n.trim()):[]},b=v.value?`/api/products/${x.params.id}`:"/api/products",p=v.value?"PUT":"POST",c=await(await fetch(b,{method:p,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(c.success)U.success(`Product ${v.value?"updated":"created"} successfully!`),C.push("/products");else throw new Error(c.message||"Failed to save product")}catch(a){console.error("Failed to save product:",a),U.error(a.message||"Failed to save product")}finally{d.value=!1}};return Q(()=>{N()}),(a,e)=>{const b=i("v-icon"),p=i("v-btn"),u=i("v-col"),c=i("v-row"),n=i("v-card-title"),r=i("v-text-field"),_=i("v-select"),k=i("v-textarea"),V=i("v-card-text"),y=i("v-card"),B=i("v-img"),I=i("v-avatar"),M=i("v-file-input"),z=i("v-form");return X(),Z("div",null,[l(c,{class:"mb-6"},{default:t(()=>[l(u,{cols:"12"},{default:t(()=>[m("div",te,[l(p,{icon:"",variant:"text",onClick:e[0]||(e[0]=s=>a.$router.go(-1)),class:"mr-4"},{default:t(()=>[l(b,null,{default:t(()=>[...e[18]||(e[18]=[w("mdi-arrow-left",-1)])]),_:1})]),_:1}),m("div",null,[m("h1",ae,q(v.value?"Edit Product":"Add New Product"),1),m("p",oe,q(v.value?"Update product information":"Create a new product in your catalog"),1)])])]),_:1})]),_:1}),l(z,{ref:"form",modelValue:P.value,"onUpdate:modelValue":e[17]||(e[17]=s=>P.value=s),onSubmit:Y(j,["prevent"])},{default:t(()=>[l(c,null,{default:t(()=>[l(u,{cols:"12",lg:"8"},{default:t(()=>[l(y,{class:"dashboard-card pa-6 mb-6"},{default:t(()=>[l(n,{class:"pb-4"},{default:t(()=>[...e[19]||(e[19]=[m("h2",{class:"text-h6 font-weight-bold"},"Product Information",-1)])]),_:1}),l(V,null,{default:t(()=>[l(c,null,{default:t(()=>[l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.name=s),label:"Product Name *",variant:"outlined",rules:R,required:"",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.sku,"onUpdate:modelValue":e[2]||(e[2]=s=>o.sku=s),label:"SKU *",variant:"outlined",rules:D,required:"",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(_,{modelValue:o.category,"onUpdate:modelValue":e[3]||(e[3]=s=>o.category=s),items:h.value,label:"Category *",variant:"outlined",rules:E,required:"",disabled:d.value},null,8,["modelValue","items","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.price,"onUpdate:modelValue":e[4]||(e[4]=s=>o.price=s),modelModifiers:{number:!0},label:"Price (â‚¬) *",type:"number",step:"0.01",variant:"outlined",rules:T,required:"",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.stock_quantity,"onUpdate:modelValue":e[5]||(e[5]=s=>o.stock_quantity=s),modelModifiers:{number:!0},label:"Stock Quantity *",type:"number",variant:"outlined",rules:A,required:"",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(_,{modelValue:o.status,"onUpdate:modelValue":e[6]||(e[6]=s=>o.status=s),items:F.value,label:"Status *",variant:"outlined",rules:O,required:"",disabled:d.value},null,8,["modelValue","items","disabled"])]),_:1}),l(u,{cols:"12"},{default:t(()=>[l(k,{modelValue:o.description,"onUpdate:modelValue":e[7]||(e[7]=s=>o.description=s),label:"Description",variant:"outlined",rows:"4",disabled:d.value},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l(y,{class:"dashboard-card pa-6"},{default:t(()=>[l(n,{class:"pb-4"},{default:t(()=>[...e[20]||(e[20]=[m("h2",{class:"text-h6 font-weight-bold"},"Additional Information",-1)])]),_:1}),l(V,null,{default:t(()=>[l(c,null,{default:t(()=>[l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.weight,"onUpdate:modelValue":e[8]||(e[8]=s=>o.weight=s),label:"Weight (kg)",type:"number",step:"0.01",variant:"outlined",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.dimensions,"onUpdate:modelValue":e[9]||(e[9]=s=>o.dimensions=s),label:"Dimensions (L x W x H)",variant:"outlined",placeholder:"10 x 5 x 2 cm",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.brand,"onUpdate:modelValue":e[10]||(e[10]=s=>o.brand=s),label:"Brand",variant:"outlined",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12",md:"6"},{default:t(()=>[l(r,{modelValue:o.supplier,"onUpdate:modelValue":e[11]||(e[11]=s=>o.supplier=s),label:"Supplier",variant:"outlined",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),l(u,{cols:"12"},{default:t(()=>[l(k,{modelValue:o.tags,"onUpdate:modelValue":e[12]||(e[12]=s=>o.tags=s),label:"Tags",variant:"outlined",rows:"2",placeholder:"Comma separated tags",disabled:d.value},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12",lg:"4"},{default:t(()=>[l(y,{class:"dashboard-card pa-6 mb-6"},{default:t(()=>[l(n,{class:"pb-4"},{default:t(()=>[...e[21]||(e[21]=[m("h2",{class:"text-h6 font-weight-bold"},"Product Image",-1)])]),_:1}),l(V,null,{default:t(()=>[m("div",se,[l(I,{size:"120",class:"mb-4"},{default:t(()=>[l(B,{src:S.value||"/placeholder-product.png",alt:"Product image"},null,8,["src"])]),_:1}),l(M,{modelValue:g.value,"onUpdate:modelValue":e[13]||(e[13]=s=>g.value=s),label:"Choose image",accept:"image/*",variant:"outlined","prepend-icon":"mdi-camera",disabled:d.value,onChange:$},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),l(y,{class:"dashboard-card pa-6 mb-6"},{default:t(()=>[l(n,{class:"pb-4"},{default:t(()=>[...e[22]||(e[22]=[m("h2",{class:"text-h6 font-weight-bold"},"SEO Settings",-1)])]),_:1}),l(V,null,{default:t(()=>[l(r,{modelValue:o.seo_title,"onUpdate:modelValue":e[14]||(e[14]=s=>o.seo_title=s),label:"SEO Title",variant:"outlined",disabled:d.value,class:"mb-4"},null,8,["modelValue","disabled"]),l(k,{modelValue:o.seo_description,"onUpdate:modelValue":e[15]||(e[15]=s=>o.seo_description=s),label:"SEO Description",variant:"outlined",rows:"3",disabled:d.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),l(y,{class:"dashboard-card pa-6"},{default:t(()=>[l(n,{class:"pb-4"},{default:t(()=>[...e[23]||(e[23]=[m("h2",{class:"text-h6 font-weight-bold"},"Actions",-1)])]),_:1}),l(V,null,{default:t(()=>[l(p,{type:"submit",color:"primary",size:"large",block:"",loading:d.value,disabled:!P.value||d.value,class:"mb-3"},{default:t(()=>[l(b,{left:""},{default:t(()=>[...e[24]||(e[24]=[w("mdi-content-save",-1)])]),_:1}),w(" "+q(v.value?"Update Product":"Create Product"),1)]),_:1},8,["loading","disabled"]),l(p,{variant:"outlined",size:"large",block:"",onClick:e[16]||(e[16]=s=>a.$router.go(-1)),disabled:d.value},{default:t(()=>[...e[25]||(e[25]=[w(" Cancel ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),re=ee(de,[["__scopeId","data-v-fb4dc5db"]]);export{re as default};
